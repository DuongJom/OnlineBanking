{% extends "user/layout.html" %}

{% block title %}
    Transfer Money
{% endblock %}

{% block user_content %}
<div class="min-h-screen flex items-center justify-center bg-gray-100">
    <form method="post" action="/money-transfer"
        class="w-full sm:w-2/3 md:w-1/2 lg:w-2/5 bg-white shadow-xl rounded-2xl p-8">

        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        <h2 class="text-2xl font-bold text-center text-green-700 mb-6">Domestic Money Transfer</h2>

        <!-- Source Account Info -->
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
            <div class="flex justify-between mb-2 text-sm">
                <span class="font-semibold text-gray-700">Source Account:</span>
                <span class="bg-green-200 px-3 py-1 rounded text-gray-800">{{ account.AccountNumber }}</span>
            </div>
            <div class="flex justify-between text-sm">
                <span class="font-semibold text-gray-700">Balance:</span>
                <span class="text-red-600 font-bold">
                    {{ account.Balance | currency_format }}
                    <sup>{{ account.Currency | currency_to_text }}</sup>
                </span>
            </div>
        </div>

        <!-- Receiver Info -->
        <h3 class="text-lg font-semibold mb-4 text-gray-700">Receiver Information</h3>
        <div class="space-y-5">
            <!-- Dropdown for Bank -->
            <div>
                <label for="receiver_bank" class="block text-sm font-medium mb-1 text-gray-600">Receiver Bank</label>
                <div class="relative">
                    <button id="dropdownBank" type="button"
                        class="w-full text-left px-4 py-2 border border-gray-300 bg-gray-100 rounded-md shadow-sm text-sm">
                        Select a Bank
                    </button>
                    <input id="receiver_bank" type="hidden" name="receiver_bank">
                    <ul id="dropdownMenu"
                        class="absolute z-20 w-full max-h-52 mt-2 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                        {% for bank in banks %}
                        <li class="flex items-center px-4 py-2 text-sm cursor-pointer hover:bg-gray-100"
                            data-value="{{ bank.shortName }} - {{ bank.name }}" data-logo="{{ bank.logo }}">
                            <img src="{{ bank.logo }}" alt="{{ bank.shortName }}" class="h-5 w-5 mr-2 rounded-full">
                            {{ bank.shortName }} - {{ bank.name }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <!-- Receiver Account -->
            <div>
                <label for="receiver_account" class="block text-sm font-medium mb-1 text-gray-600">Receiver Account Number</label>
                <input type="number" id="receiver_account" name="receiver_account"
                    class="w-full border border-gray-300 rounded-md h-10 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-green-400"
                    placeholder="Enter receiver account number">
            </div>
        </div>

        <!-- Transaction Info -->
        <h3 class="text-lg font-semibold mt-8 mb-4 text-gray-700">Transaction Information</h3>
        <div class="space-y-5">
            <!-- Amount -->
            <div>
                <label for="amount" class="block text-sm font-medium mb-1 text-gray-600">Amount</label>
                <div class="flex">
                    <input type="number" id="amount" name="amount"
                        class="w-full border border-gray-300 rounded-l-md h-10 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-green-400"
                        placeholder="Enter amount">
                    <select id="currency" name="currency"
                        class="border border-gray-300 rounded-r-md h-10 text-sm focus:outline-none">
                        <option value="0">VND</option>
                        <option value="1">USD</option>
                        <option value="2">EUR</option>
                    </select>
                </div>
            </div>

            <!-- Message -->
            <div>
                <label for="message" class="block text-sm font-medium mb-1 text-gray-600">Message</label>
                <input type="text" id="message" name="message"
                    value="{{ owner.Name }} transfer money"
                    class="w-full border border-gray-300 rounded-md h-10 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-green-400">
            </div>
        </div>

        <!-- Submit -->
        <button type="submit"
            class="w-full mt-8 bg-green-500 hover:bg-green-600 text-white font-semibold py-2 rounded-md transition-all">
            Continue
        </button>
    </form>
</div>

<script>
    const dropdownButton = document.getElementById('dropdownBank');
    const dropdownMenu = document.getElementById('dropdownMenu');
    const dropdownItems = dropdownMenu.querySelectorAll('li');
    const receiverBankInput = document.getElementById('receiver_bank');

    dropdownButton.addEventListener('click', () => {
        dropdownMenu.classList.toggle('hidden');
    });

    dropdownItems.forEach(item => {
        item.addEventListener('click', () => {
            const bankName = item.getAttribute('data-value');
            dropdownButton.textContent = bankName;
            receiverBankInput.value = bankName.split('-')[1].trim();
            dropdownMenu.classList.add('hidden');
        });
    });

    document.addEventListener('click', (event) => {
        if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
            dropdownMenu.classList.add('hidden');
        }
    });
</script>
{% endblock %}