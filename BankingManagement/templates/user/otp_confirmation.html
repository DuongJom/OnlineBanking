{% extends "general/layout.html" %}
{% block title %} OTP Confirmation {% endblock %}
{% block content %}
<div class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-md w-96">
        <form method="post" action="/confirm-otp">
            <input type="hidden" name="csrf_token" value = "{{ csrf_token() }}" /> 
            <h2 class="text-2xl font-semibold text-center text-gray-700 mb-6">Enter OTP</h2>
            <p class="text-center text-gray-600 mb-6">We have sent an OTP to your email. Please enter it below to verify your identity.</p>
            <div class="mt-4 text-center">
                <p id="countdown" class="text-sm text-gray-600">Resend OTP in 
                    <span id="time" class="text-red-600">01:00</span>
                </p>
            </div>
            <!-- OTP input fields -->
            <div class="flex justify-between space-x-2 mb-6">
                <input id="otp1" name="otp1" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
                <input id="otp2" name="otp2" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
                <input id="otp3" name="otp3" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
                <input id="otp4" name="otp4" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
                <input id="otp5" name="otp5" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
                <input id="otp6" name="otp6" type="text" maxlength="1" class="otp-input w-12 h-12 text-center text-xl border rounded-md focus:ring-2 focus:ring-blue-500" />
            </div>
    
            <!-- Submit button -->
            <input type="submit" value="Verify OTP" id="verifyBtn"
                class="w-full py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"/>
    
            <div class="mt-4 text-center">
                <p class="text-sm text-gray-600">Didn't receive the OTP? <a href="#" class="text-blue-600 hover:underline">Resend OTP</a></p>
            </div>
        </form>
    </div>
</div>
<script>
    // Set the countdown time to 1 minute (60 seconds)
    let countdownTime = 60;

    // Function to update the countdown timer
    function updateCountdown() {
        let minutes = Math.floor(countdownTime / 60);
        let seconds = countdownTime % 60;

        // Format the time with leading zeros
        let timeFormatted = `${minutes < 10 ? '0' : ''}${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

        // Update the timer on the page
        document.getElementById('time').textContent = timeFormatted;

        // If time is up, stop the countdown
        if (countdownTime === 0) {
            clearInterval(timerInterval);
            document.getElementById('countdown').textContent = 'You can now resend the OTP.';
            document.getElementById('verifyBtn').disabled = true;
        } else {
            countdownTime--;
            document.getElementById('verifyBtn').disabled = false;
        }
    }

    // Start the countdown
    const timerInterval = setInterval(updateCountdown, 1000);

    // Add event listener to all OTP input fields
    const otpInputs = document.querySelectorAll('.otp-input');
        
    otpInputs.forEach((input, index) => {
        input.addEventListener('input', function() {
            // If the current input is filled, focus on the next one
            if (input.value.length === 1 && index < otpInputs.length - 1) {
                otpInputs[index + 1].focus();
            }

            // Optional: If the user deletes a value, focus the previous input
            if (input.value.length === 0 && index > 0) {
                otpInputs[index - 1].focus();
            }
        });
    });
</script>
{% endblock %}
